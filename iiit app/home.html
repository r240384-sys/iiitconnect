<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IIIT Connect - Home</title>
    <link rel="icon" href="images/logo.png" type="image/png">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <!-- Data Scripts -->
    <script src="js/users.js"></script>
    <script src="js/data.js"></script>
    <script src="js/timetable_data.js"></script>
    <script src="admin/js/db_sync.js"></script>
</head>

<body>
    <!-- Preloader -->
    <div id="preloader">
        <div class="loader"></div>
    </div>
    <script>
        window.addEventListener('load', () => {
            const preloader = document.getElementById('preloader');
            preloader.classList.add('fade-out');
            setTimeout(() => {
                preloader.style.display = 'none';
            }, 500);
        });
    </script>

    <header>
        <div class="container">
            <nav>
                <div class="logo" style="display: flex; align-items: center;">
                    <img src="images/logo.png" alt="Logo" style="height: 40px; margin-right: 12px;">
                    <div>
                        <span id="campus-name" style="display: block; line-height: 1;">IIIT Connect</span>
                        <span
                            style="font-weight: 300; font-size: 0.9rem; color: var(--text-light); display: block;">Academic
                            Portal</span>
                    </div>
                </div>
                <div class="nav-links" style="display: flex; align-items: center;">
                    <span id="user-greeting"
                        style="margin-right: 15px; font-weight: 600; color: var(--text-dark);"></span>

                    <div class="user-dropdown">
                        <button class="user-icon-btn" onclick="toggleDropdown()">
                            <i class="fas fa-user"></i>
                        </button>
                        <div id="dropdown-menu" class="dropdown-menu">
                            <div class="dropdown-item"
                                style="cursor: default; font-weight: 600; border-bottom: 1px solid #eee;">
                                <span id="dropdown-name">Student</span>
                            </div>
                            <a href="index.html" class="dropdown-item">
                                <i class="fas fa-map-marker-alt"></i> Change Campus
                            </a>
                            <div class="dropdown-item" onclick="logout()" style="color: #ef4444;">
                                <i class="fas fa-sign-out-alt"></i> Logout
                            </div>
                        </div>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <div class="container" style="padding-top: 100px; padding-bottom: 60px;">
        <div style="text-align: center; margin-bottom: 50px;">
            <h1 style="font-family: 'Playfair Display', serif; font-size: 3rem; margin-bottom: 10px;">Select Your
                Academic Year</h1>
            <p style="color: var(--text-light); font-size: 1.1rem;">Choose your current year to access customized
                syllabus and resources</p>
        </div>

        <!-- pre-University Course (PUC) -->
        <div class="year-section-title" style="text-align: center;">Pre-University Course</div>
        <div class="year-grid" style="justify-content: center; display: flex;">
            <a href="dashboard.html?year=puc2" class="year-card bg-puc animate-delay-2"
                style="animation: fadeIn 0.8s ease-out forwards; opacity: 0; max-width: 350px;">
                <div class="year-card-bg bg-puc" style="filter: brightness(0.9);"></div>
                <div class="year-card-content">
                    <h3>PUC 2</h3>
                    <p>Second Year Inter</p>
                </div>
                <div class="year-icon"><i class="fas fa-tree"></i></div>
            </a>
        </div>
    </div>

    <script>
        // Check Auth
        const userStr = localStorage.getItem('user');
        if (!userStr) {
            window.location.href = 'login.html';
        } else {
            // Auto-redirect to PUC2 Dashboard
            window.location.href = 'dashboard.html?year=puc2';

            /* Previous Home Logic Removed for Direct Access
            const user = JSON.parse(userStr);
            // Personalized Greeting
            document.getElementById('user-greeting').innerText = `Hello, ${user.name.split(' ')[0]}`;
            document.getElementById('dropdown-name').innerText = user.id;
            */
        }

        // Set Campus Name
        const campus = localStorage.getItem('selectedCampus') || 'RGUKT';
        document.getElementById('campus-name').innerText = campus;

        // Dropdown Logic
        function toggleDropdown() {
            document.getElementById('dropdown-menu').classList.toggle('show');
        }

        // Close dropdown when clicking outside
        window.onclick = function (event) {
            if (!event.target.closest('.user-dropdown')) {
                var dropdowns = document.getElementsByClassName("dropdown-menu");
                for (var i = 0; i < dropdowns.length; i++) {
                    var openDropdown = dropdowns[i];
                    if (openDropdown.classList.contains('show')) {
                        openDropdown.classList.remove('show');
                    }
                }
            }
        }

        function logout() {
            localStorage.removeItem('user');
            window.location.href = 'index.html';
        }
    </script>
</body>

</html>